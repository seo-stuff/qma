# Query Monitoring Analyzer

Скрипт на Python для анализа поисковых запросов и посадочных страниц из Яндекс.Вебмастера (Мониторинг запросов).

## Возможности

- Автоматическое определение типа отчёта (анализ запросов или страниц)
- Обработка файлов выгрузки из Яндекс.Вебмастера с любым именем
- Фильтрация данных по списку URL из файла urls.txt
- Расчёт ключевых метрик:
  - Для запросов:
    - Средняя и медианная позиции
    - Ежедневная и общая частотность
    - Статистика кликов
    - Процент охвата
    - Анализ количества слов
  - Для страниц:
    - Средняя позиция
    - Статистика показов и кликов
    - Анализ CTR
- Автоматическая настройка ширины столбцов в выходном Excel-файле
- Статистика слов для семантического анализа

## Требования

- Python 3.x
- Необходимые библиотеки:
  ```
  pandas
  openpyxl
  ```

## Установка

1. Установите Python с [официального сайта](https://www.python.org/downloads/windows/)
2. При установке обязательно поставьте галочку "Add Python to PATH"
3. Установите необходимые библиотеки через pip:
   ```bash
   pip install pandas openpyxl
   ```

## Использование

1. Скачайте отчёт из раздела "Мониторинг запросов" Яндекс.Вебмастера
2. Поместите Excel-файл в одну папку со скриптом
3. Опционально: создайте файл urls.txt в той же папке и добавьте в него список URL-адресов для фильтрации (по одному адресу на строку)
4. Запустите скрипт
5. Выберите нужный файл из списка предложенных
6. Введите адрес вашего сайта в формате https://site.ru
7. Скрипт автоматически:
   - Определит тип отчёта
   - При наличии urls.txt отфильтрует данные по указанным URL
   - Обработает данные
   - Сформирует файл с результатами анализа

## Результаты

Скрипт создаёт Excel-файл со следующим форматом названия:
- Для отчётов по запросам: `{домен}-semantics-{дата}.xlsx`
- Для отчётов по страницам: `{домен}-pages-{дата}.xlsx`

### Отчёт по запросам содержит:
- Основной лист с проанализированными данными по запросам
- Дополнительный лист со статистикой слов

### Отчёт по страницам содержит:
- Проанализированные данные по страницам с метриками: средняя позиция, показы и CTR

## История изменений

### Версия 4.1 (07.11.2024)
- Добавлена возможность фильтрации данных по списку URL из файла urls.txt
- Автоматическое определение наличия файла фильтрации
- Вывод статистики по отфильтрованным данным

### Версия 4.0 (04.11.2024)
- Обновлен формат входного файла в связи с изменениями со стороны Яндекса
- Больше не надо переименовывать файл в wm.xlsx, просто запускаем скрипт из той же папки, куда сохранили отчет с любым названием и выбираем подходящий файл
- Авто определение режима анализа - отчет по страницам или отчет по запросам
- Для режима запросов дополнительно считаем медианную позицию, чтобы убрать влияние сильных отклонений
- Оптимизировал код, убрал лишнее, облегчил на сколько возможно

### Версия 3.3 (27.02.2024)
- Добавлен режима анализа URL (в случае, если выгрузка делается для URL, а не запросов)
- Облегчен код, удален анализ брендовых запросов
- Работа идёт с одним файлом - wm.xlsx, для обоих режимов сохраняем отчеты все равно в него

### Версия 3.2 (19.01.2024)
- Исправлен вывод пояснений на отдельном листе

### Версия 3.1 (19.01.2024)
- Улучшен код
- Причесаны данные в Excel файле
- Добавлен подсчет количества слов

### Версия 3.0 (18.01.2024)
- Автооткрытие файла после генерации
- Удален функционал коммерциализации по вхождению (слишком много частных случаев, в случае необходимости можно пользовать версией 2.0)

### Версия 2.0 (15.01.2024)
- Удален подсчет мелькания и ядра (оказались бесполезны)
- Добавлена статистика по словам из запросов (для быстрой аналитики, например, выявления запросов с вхождением бренда, либо ненужным ГЕО, ...)
- Добавлен подсчет среднего числа кликов и суммы кликов за 14 дней
- Добавлено автоматическое определение коммерциализации по вхождению слов. Список можно редактивровать самостоятельно в настройках

### Версия 1.0 (24.12.2023)
- Первая версия скрипта
